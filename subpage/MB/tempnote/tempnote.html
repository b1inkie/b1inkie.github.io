<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>b1ink</title>
    <link rel="stylesheet" href="../../../css/sidebar-flex.css">
    <link rel="shortcut icon" href="../../../images/misc/onotera32x32-circle.ico"> 
    <script src="../../../clipboard.js-master/dist/clipboard.min.js"></script>
</head>

<body>
    <script>
        (function () {
            var a_idx = 0;
            window.onclick = function (event) {
                var a = new Array("我以前和你一样也是个冒险家，直到我的膝盖中了一箭。","Wait,I Know u","Let me guess...Someone stole your sweetroll?","Fus Ro Dah.","Some people call it junk, me, I call them treasure.","It's a fine day with you around.","Food for the hungry, and drink for the thirsty.",
                    );
 
                var heart = document.createElement("b"); //创建b元素
                heart.onselectstart = new Function('event.returnValue=false'); //防止拖动
 
                document.body.appendChild(heart).innerHTML = a[a_idx]; //将b元素添加到页面上
                a_idx = (a_idx + 1) % a.length;
                heart.style.cssText = "position: fixed;left:-100%;"; //给p元素设置样式
 
                var f = 16, // 字体大小
                    x = event.clientX - f / 2, // 横坐标
                    y = event.clientY - f, // 纵坐标
                    c = randomColor(), // 随机颜色
                    a = 1, // 透明度
                    s = 1.0; // 放大缩小
 
                var timer = setInterval(function () { //添加定时器
                    if (a <= 0) {
                        document.body.removeChild(heart);
                        clearInterval(timer);
                    } else {
                        heart.style.cssText = "font-size:16px;cursor: default;position: fixed;color:" +
                            c + ";left:" + x + "px;top:" + y + "px;opacity:" + a + ";transform:scale(" +
                            s + ");";
 
                        y--;
                        a -= 0.016;
                        s += 0.002;
                    }
                }, 15)
 
            }
            // 随机颜色
            function randomColor() {
 
                return "rgb(" + (~~(Math.random() * 255)) + "," + (~~(Math.random() * 255)) + "," + (~~(Math
                .random() * 255)) + ")";
 
            }
        }());
    </script>
    <div class="bigbox">
        <input type="checkbox" id="checkbox"/>

        <label for="checkbox">
            <img src="../../../images/misc/tesv-logo.png" alt="sidebar-hide">
            <span>&emsp;<i>临时笔记(点左侧 logo 隐藏侧边栏)</i></span>
        </label>
        <ul>
            <li>
                <img src="../../../images/misc/onotera64x64.png" alt="头像" />
                <span>b1ink<br/><font size=1>学习使我快乐:doge:</font></span>
            </li>
            <!--intro-->
            <li>
                <a href="../../../index.html">
                    <img src="../../../images/quest-logo/dragon-logo.png" alt="1">
                    <span>INTRO</span>
                </a>
            </li>
            <!--DST-->
            <li>
                <a>
                    <img src="../../../images/quest-logo/dragon-logo.png" alt="2">
                    <span>DST</span>
                </a>
            </li>
            <li>
                <b>
                    <a href="../../../subpage/DST/mycookpoot/mycookpot.html">
                        <img src="../../../images/quest-logo/dragon-logo.png" alt="2">
                        <span><p style="font-family:Microsoft YaHei">写一个烹煮锅</p></span>
                    </a>
                </b>
            </li>
            <li>
                <b>
                    <a href="../../../subpage/DST/myfirstsword/myfirstsword.html">
                        <img src="../../../images/quest-logo/dragon-logo.png" alt="d">
                        <span><p style="font-family:Microsoft YaHei">从0开始做一把武器</p></span>
                    </a>
                </b>
            </li>
            <!--Mount&Blade-->
            <li>
                <a>
                    <img src="../../../images/quest-logo/dragon-logo.png" alt="2">
                    <span>Mount&Blade</span>
                </a>
            </li>
            <li>
                <b>
                    <a href="#">
                        <img src="../../../images/quest-logo/dragon-logo.png" alt="d">
                        <span><p style="font-family:Microsoft YaHei">临时笔记</p></span>
                    </a>
                </b>
            </li>
            <li>
                <b>
                    <a href="../../../subpage/MB/extratext/extratext.html">
                        <img src="../../../images/quest-logo/dragon-logo.png" alt="d">
                        <span><p style="font-family:Microsoft YaHei">物品添加额外描述</p></span>
                    </a>
                </b>
            </li>
            <li>
                <b>
                    <a href="../../../subpage/MB/MBWbEditor/MBWbEditor.html">
                        <img src="../../../images/quest-logo/dragon-logo.png" alt="d">
                        <span><p style="font-family:Microsoft YaHei">魔球触发器</p></span>
                    </a>
                </b>
            </li>
            <li>
                <b>
                    <a href="../../../subpage/MB/txt/txtmain.html">
                        <img src="../../../images/quest-logo/dragon-logo.png" alt="d">
                        <span><p style="font-family:Microsoft YaHei">TXT篇</p></span>
                    </a>
                </b>
            </li>
            <li>
                <b>
                    <a href="../../../subpage/MB/others/others.html">
                        <img src="../../../images/quest-logo/dragon-logo.png" alt="d">
                        <span><p style="font-family:Microsoft YaHei">杂项</p></span>
                    </a>
                </b>
            </li>
        </ul>
    </div>
    <div class="workzone">
        <div class="output_wrapper" id="output_wrapper_id" style="font-size: 16px; color: rgb(62, 62, 62); line-height: 1.6; word-spacing: 0px; letter-spacing: 0px; font-family: 'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;"><h1 id="hspanstylecolor5bdaedconversationtxtspannpc" style="color: inherit; line-height: inherit; padding: 0px; margin: 1.5em 0px; font-weight: bold; font-size: 1.6em;"><span style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;"><span style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: #5bdaed;">conversation.txt</span> 修改 之 给NPC添加"问兵"功能</span></h1>
<h2 id="h" style="color: inherit; line-height: inherit; padding: 0px; margin: 1.5em 0px; font-weight: bold; font-size: 1.4em;"><span style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;">一头雾水的标题拜群友的造词能力所赐</span></h2>
<h4 id="htroop" style="color: inherit; line-height: inherit; padding: 0px; margin: 1.5em 0px; font-weight: bold; font-size: 1.2em;"><span style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;">详细描述：给指定troop添加一句新的对话：“你能帮我弄点士兵吗？”。然后随机给几名士兵到玩家部队。一周一次。</span></h4>
<h5 id="h-1" style="color: inherit; line-height: inherit; padding: 0px; margin: 1.5em 0px; font-weight: bold; font-size: 1em;"><span style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;">略微分析：</span></h5>
<p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.5em 0px;">·添加对话到<strong style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold;"><span style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: #5bdaed;">指定troop</span></strong>，可以用<strong style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold;"><code style="font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(233, 105, 0); background: rgb(248, 248, 248);">(eq,"$g_talk_troop",&lt;troop_id&gt;)</code></strong>来筛选;<br>·随机士兵种类：可以事先给士兵编好号，然后随机一下;<br>·至于一周一次，其实和酒馆请客喝酒一样，我们需要在variables.txt中设置一个全局变量用来存储本次“问兵”时的游戏天数，与下次问兵时获取的天数进行相减，并与7(天)对比即可。</p>
<hr style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; height: 1px; margin: 1.5rem 0px; border-right: none; border-bottom: none; border-left: none; border-image: initial; border-top: 1px dashed rgb(165, 165, 165);">
<p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.5em 0px;">先来复习一下 与NPC对话的框架（以潘德395为例）：<br>·玩家的台词：<br><code style="font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(233, 105, 0); background: rgb(248, 248, 248);">dlga_xxx:xxx &lt;1-代表这是一句玩家的台词的代号&gt; &lt;2-选择支窗格的代号&gt; &lt;3-触发条件代码的行数&gt; &lt;4-触发条件的代码&gt; &lt;5-玩家台词_下划线表示空格&gt; &lt;6-跳转到NPC回复台词的窗格代号&gt; &lt;7-触发结果代码的行数&gt; &lt;8-触发结果的代码&gt; NO_VOICEOVER</code><br>·NPC的台词：<br><code style="font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(233, 105, 0); background: rgb(248, 248, 248);">dlga_xxx:xxx &lt;1-代表这是一句NPC的台词的代号&gt; &lt;2-NPC台词窗格的代号&gt; &lt;3-触发条件代码的行数&gt; &lt;4-触发条件的代码&gt; &lt;5-NPC台词_下划线表示空格&gt; &lt;6-链接玩家台词，即选择支窗格的代号&gt; &lt;7-触发结果代码的行数&gt; &lt;8-触发结果的代码&gt; NO_VOICEOVER</code><br>以潘德395为例，69631表示玩家的话，也就是选择支；4095表示NPC的话。<br>那么如何找到这两个数字，很简单，看一下(汉化)台词就可以了。<br><br></p><figure style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;"><figure style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;"><img src="images/frame-intro-01.png" alt="对话窗口" title="对话窗口" style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;"><figcaption style="line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;">对话窗口</figcaption></figure></figure><br><p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.5em 0px;"></p>
<h5 id="h3spanstylecolordc143cspan" style="color: inherit; line-height: inherit; padding: 0px; margin: 1.5em 0px; font-weight: bold; font-size: 1em;"><span style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;">以下3段为<strong style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold;"><span style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: #dc143c;">重点</span></strong>，请仔细阅读（尤其是<em style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-style: italic;">林月</em>）：</span></h5>
<p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.5em 0px;">·如图所示，左上角白框部分显示谈话对象的，我们不管；<br>·右上角蓝框部分代表NPC的台词窗格，如果你想要这一句话是<strong style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold;"><span style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: #5bdaed;">NPC说的</span></strong>，那么第一个参数就要填4095，而第二个参数则特指“什么事，我的队长大人”这句话，参数3，4，5已写的很清楚了。那么，只有白框和蓝框NPC的台词窗格，整个画面是不完整的，所以第6个参数一定要链接玩家的台词，也就是选择支窗格代号。<br>·下面红框部分代表玩家的台词，即选择支窗格，如果你想要这一句话是<strong style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold;"><span style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: #5bdaed;">玩家说的</span></strong>，那么第一个参数就要填69631,第二个参数则特指这整个红框内所有选择支所在的窗格代号，也就是说这每一句选择支的第二个参数都是一样的，那么怎么表示顺序呢，撰写顺序就是显示顺序！参数3，4，5依旧略过。我们点选了一个选择支后，谈话对象要回复我们一句话，所以，第6个参数一定要跳转到NPC的台词窗格代号。当然你也可以选择直接跳转到 关闭窗口 来结束对话。<br><del style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-style: italic;"><em style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-style: italic;">虽然我很想再举个实例，但这次就算了，会放到conversation修改指南中讲。</em></del></p>
<hr style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; height: 1px; margin: 1.5rem 0px; border-right: none; border-bottom: none; border-left: none; border-image: initial; border-top: 1px dashed rgb(165, 165, 165);">
<h4 id="h-2" style="color: inherit; line-height: inherit; padding: 0px; margin: 1.5em 0px; font-weight: bold; font-size: 1.2em;"><span style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;">正文：</span></h4>
<h5 id="h-3" style="color: inherit; line-height: inherit; padding: 0px; margin: 1.5em 0px; font-weight: bold; font-size: 1em;"><span style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;">·添加对话：</span></h5>
<p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.5em 0px;"><strong style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold;">现要给NPC对话的主菜单，添加一个始终显示的选择支“你能帮我找点士兵吗？”，点击进入后，会有1个确认选择支，1个返回选择支（一定要写返回，否则对话就进行不下去，最终只能任务管理器强退），而确认选择支，一周只能点一次。成功点击后，会给玩家若干个士兵。</strong></p>
<p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.5em 0px;">假设我们要在“待在后面，不要加入战斗……”下面添加一个选择支，我们可以借助汉化文件..\languages\cns\dialogs.csv帮我们进行定位,找到该句为:<code style="font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(233, 105, 0); background: rgb(248, 248, 248);">dlga_member_talk:member_dont_fight_okay 69631 15 …</code>可以看到该选择支窗格编号为15<br>另起一行添加：<br><strong style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold;"><span style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: #66cdaa;">1.</span></strong> <strong style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold;"><code style="font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(233, 105, 0); background: rgb(248, 248, 248);">dlga_npc_talk_menu_1:ask_for_troops 69631 15 条件行数 条件代码 I_need_some_hands,_got_any_idea? 12138 0 NO_VOICEOVER</code></strong><br>汉化：dlga_npc_talk_menu_1:ask_for_troops|我 需 要 些 人 手 ，你 能 帮 我 找 些 来 吗 ？<br>如上所示，后面的12138这个数字是可以随便填的，但要注意不得与MOD已存在的窗格编号重复，可以搜索 <strong style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold;">空格12138空格</strong> 来确认是否有重复。<br><strong style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold;">本句中的触发条件，仅用来筛选我们谈话的对象是不是指定NPC</strong><br>一句即可<strong style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold;"><code style="font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(233, 105, 0); background: rgb(248, 248, 248);">(eq,"$g_talk_troop","指定NPC的兵种ID"),</code></strong><br><strong style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold;"><span style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: #66cdaa;">2.</span></strong> <strong style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold;"><code style="font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(233, 105, 0); background: rgb(248, 248, 248);">dlga_npc_talk_menu_2:npc_reply_1 4095 12138 0 I'm_glad_to_help_you. 12139 0 NO_VOICEOVER</code></strong><br>汉化：dlga_npc_talk_menu_2:npc_reply_1|我 很 愿 意 帮 助 你 ，大 人 。（1 周 1 次 ）<br><strong style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold;"><span style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: #66cdaa;">3.</span></strong> <strong style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold;"><code style="font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(233, 105, 0); background: rgb(248, 248, 248);">dlga_npc_talk_menu_2:p_confirm 69631 12139 条件行数 条件代码 very_well. 12140 结果行数 结果代码 NO_VOICEOVER</code></strong><br>汉化：dlga_npc_talk_menu_2:p_confirm|有 劳 了 。<br><strong style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold;"><span style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: #66cdaa;">4.</span></strong> <strong style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold;"><code style="font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(233, 105, 0); background: rgb(248, 248, 248);">dlga_npc_talk_menu_2:p_cancel 69631 12139 0 Never_mind. 12140 0 NO_VOICEOVER</code></strong><br>汉化：dlga_npc_talk_menu_2:p_cancel|想 想 还 是 算 了 。<br><strong style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold;"><span style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: #66cdaa;">5.</span></strong> <strong style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold;"><code style="font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(233, 105, 0); background: rgb(248, 248, 248);">dlga_npc_talk_menu_2:npc_back_to_menu_1 4095 12140 0 Never_mind. 15 0 NO_VOICEOVER</code></strong><br>汉化：dlga_npc_talk_menu_2:npc_back_to_menu_1|还 有 什 么 事 吗 ？</p>
<h5 id="h-4" style="color: inherit; line-height: inherit; padding: 0px; margin: 1.5em 0px; font-weight: bold; font-size: 1em;"><span style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;">·代码部分：</span></h5>
<p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.5em 0px;">我们先在<span style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: #66cdaa;">variables.txt</span>中添加一个全局变量<strong style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold;"><code style="font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(233, 105, 0); background: rgb(248, 248, 248);">g_ask_npc_for_troops_last_time</code></strong>用来储存上一次“问兵”的时间。</p>
<p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.5em 0px;">“问兵”例如：我们要在trp_a trp_b trp_c 3个兵种中随机选取一种，数量最小为3最大为7，添加到玩家部队。<br><strong style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold;">触发条件：</strong></p>
<pre style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;"><code class="python language-python hljs" style="overflow-wrap: break-word; margin: 0px 2px; line-height: 18px; font-size: 14px; font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; color: rgb(169, 183, 198); background: rgb(40, 43, 46); overflow-x: auto; padding: 0.5em; white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;">(store_current_day,<span class="hljs-string" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">":var_0"</span>),&nbsp;<span class="hljs-comment" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(128, 128, 128); word-wrap: inherit !important; word-break: inherit !important;">#获取当前天数</span><br>(val_sub,<span class="hljs-string" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">":var_0"</span>,<span class="hljs-string" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">"$g_ask_npc_for_troops_last_time"</span>),&nbsp;<br>(gt,&nbsp;<span class="hljs-string" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">":var_0"</span>,&nbsp;<span class="hljs-number" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(174, 135, 250); word-wrap: inherit !important; word-break: inherit !important;">1</span>),<br>(troops_can_join,<span class="hljs-number" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(174, 135, 250); word-wrap: inherit !important; word-break: inherit !important;">7</span>),&nbsp;<span class="hljs-comment" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(128, 128, 128); word-wrap: inherit !important; word-break: inherit !important;">#玩家部队是否有足够空位</span><br></code></pre>
<p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.5em 0px;"><strong style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold;">触发结果：</strong></p>
<pre style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;"><code class="python language-python hljs" style="overflow-wrap: break-word; margin: 0px 2px; line-height: 18px; font-size: 14px; font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; color: rgb(169, 183, 198); background: rgb(40, 43, 46); overflow-x: auto; padding: 0.5em; white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;">(store_current_day,<span class="hljs-string" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">":var_0"</span>),&nbsp;<span class="hljs-comment" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(128, 128, 128); word-wrap: inherit !important; word-break: inherit !important;">#获取当前天数</span><br>(assign,<span class="hljs-string" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">"$g_ask_npc_for_troops_last_time"</span>,<span class="hljs-string" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">":var_0"</span>)&nbsp;<span class="hljs-comment" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(128, 128, 128); word-wrap: inherit !important; word-break: inherit !important;">#存储本次“问兵”的时间（天数）</span><br>(store_random_in_range,<span class="hljs-string" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">":troops_number"</span>,<span class="hljs-number" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(174, 135, 250); word-wrap: inherit !important; word-break: inherit !important;">3</span>,<span class="hljs-number" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(174, 135, 250); word-wrap: inherit !important; word-break: inherit !important;">7</span>),&nbsp;<span class="hljs-comment" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(128, 128, 128); word-wrap: inherit !important; word-break: inherit !important;">#获取士兵数量</span><br>(store_random_in_range,<span class="hljs-string" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">":troops_id"</span>,<span class="hljs-number" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(174, 135, 250); word-wrap: inherit !important; word-break: inherit !important;">1</span>,<span class="hljs-number" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(174, 135, 250); word-wrap: inherit !important; word-break: inherit !important;">3</span>),&nbsp;<span class="hljs-comment" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(128, 128, 128); word-wrap: inherit !important; word-break: inherit !important;">#获取士兵ID</span><br>(try_begin),<br>&nbsp;&nbsp;&nbsp;&nbsp;(eq,<span class="hljs-string" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">":troops_id"</span>,<span class="hljs-number" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(174, 135, 250); word-wrap: inherit !important; word-break: inherit !important;">1</span>)<br>&nbsp;&nbsp;&nbsp;&nbsp;(party_add_members,<span class="hljs-string" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">"p_main_party"</span>,<span class="hljs-string" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">"trp_a"</span>,<span class="hljs-string" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">":troops_number"</span>),<br>(else_try),<br>&nbsp;&nbsp;&nbsp;&nbsp;(eq,<span class="hljs-string" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">":troops_id"</span>,<span class="hljs-number" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(174, 135, 250); word-wrap: inherit !important; word-break: inherit !important;">2</span>)<br>&nbsp;&nbsp;&nbsp;&nbsp;(party_add_members,<span class="hljs-string" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">"p_main_party"</span>,<span class="hljs-string" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">"trp_b"</span>,<span class="hljs-string" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">":troops_number"</span>),<br>(else_try),<br>&nbsp;&nbsp;&nbsp;&nbsp;(eq,<span class="hljs-string" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">":troops_id"</span>,<span class="hljs-number" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(174, 135, 250); word-wrap: inherit !important; word-break: inherit !important;">3</span>)<br>&nbsp;&nbsp;&nbsp;&nbsp;(party_add_members,<span class="hljs-string" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">"p_main_party"</span>,<span class="hljs-string" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">"trp_c"</span>,<span class="hljs-string" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">":troops_number"</span>),<br>(try_end),<br></code></pre>
<p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.5em 0px;">对照改好，丢进MBCodeEditor中转成txt，即可。提一嘴MBCodeEditor最下面会显示代码的总行数。</p>
<p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.5em 0px;">·<strong style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold;"><span style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: #dc143c;">最后</span></strong>我们翻到<span style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: #66cdaa;">conversation.txt</span>的最上面可以看见第二行有个数字，这个是所有对话的行数，我们可以用总行数减去这2行算得。</p></div>

<div class="cp1" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;">
    <script type="text/javascript" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;">new ClipboardJS('.btn1');</script>
<textarea id="bar1" readonly="readonly" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;">
    ----------------------------------
dlga_npc_talk_menu_1:ask_for_troops 69631 15 0 I_need_some_hands,_got_any_idea? 12138 0 NO_VOICEOVER
dlga_npc_talk_menu_2:npc_reply_1 4095 12138 0 I'm_glad_to_help_you. 12139 0 NO_VOICEOVER
dlga_npc_talk_menu_2:p_confirm 69631 12139 条件行数 条件代码 very_well. 12140 结果行数 结果代码 NO_VOICEOVER
dlga_npc_talk_menu_2:p_cancel 69631 12139 0 Never_mind. 12140 0 NO_VOICEOVER
dlga_npc_talk_menu_2:npc_back_to_menu_1 4095 12140 0 Never_mind. 15 0 NO_VOICEOVER
----------------------------------
dlga_npc_talk_menu_1:ask_for_troops|我 需 要 些 人 手 ，你 能 帮 我 找 些 来 吗 ？
dlga_npc_talk_menu_2:npc_reply_1|我 很 愿 意 帮 助 你 ，大 人 。（1 周 1 次 ）
dlga_npc_talk_menu_2:p_confirm|有 劳 了 。
dlga_npc_talk_menu_2:p_cancel|想 想 还 是 算 了 。
dlga_npc_talk_menu_2:npc_back_to_menu_1|还 有 什 么 事 吗 ？
----------------------------------
(store_current_day,":var_0"), #获取当前天数
(val_sub,":var_0","$g_ask_npc_for_troops_last_time"), 
(gt, ":var_0", 1),
(troops_can_join,7), #玩家部队是否有足够空位
----------------------------------
(store_current_day,":var_0"), #获取当前天数
(assign,"$g_ask_npc_for_troops_last_time",":var_0") #存储本次“问兵”的时间（天数）
(store_random_in_range,":troops_number",3,7), #获取士兵数量
(store_random_in_range,":troops_id",1,3), #获取士兵ID
(try_begin),
    (eq,":troops_id",1)
    (party_add_members,"p_main_party","trp_a",":troops_number"),
(else_try),
    (eq,":troops_id",2)
    (party_add_members,"p_main_party","trp_b",":troops_number"),
(else_try),
    (eq,":troops_id",3)
    (party_add_members,"p_main_party","trp_c",":troops_number"),
(try_end),
</textarea>
<button class="btn1" data-clipboard-action="copy" data-clipboard-target="#bar1" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;">
    复制所有代码
</button>
</div>


    </div>
</body>
</html>